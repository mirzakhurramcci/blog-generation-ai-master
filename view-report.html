<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />

    <title>ContentBlitz</title>
    <meta content="" name="description" />
    <meta content="" name="keywords" />

    
    <!-- Favicons -->
    <link href="assets/img/favicon.png" rel="icon" />
    <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon" />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Raleway:300,300i,400,400i,600,600i,700,700i"
      rel="stylesheet"
    />

    <!-- Vendor CSS Files -->
    <link href="assets/vendor/aos/aos.css" rel="stylesheet" />
    <link
      href="assets/vendor/bootstrap/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="assets/vendor/bootstrap-icons/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link href="assets/vendor/boxicons/css/boxicons.min.css" rel="stylesheet" />
    <link
      href="assets/vendor/glightbox/css/glightbox.min.css"
      rel="stylesheet"
    />
    <link href="assets/vendor/swiper/swiper-bundle.min.css" rel="stylesheet" />

    <!-- Template Main CSS File -->
    <link href="assets/css/style.css" rel="stylesheet" />
    <link href="assets/css/customStyles.css" rel="stylesheet" />

    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css"
      integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO"
      crossorigin="anonymous"
    />
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <!-- =======================================================
  * Template Name: Ninestars
  * Updated: May 30 2023 with Bootstrap v5.3.0
  * Template URL: https://bootstrapmade.com/ninestars-free-bootstrap-3-theme-for-creative/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
  </head>

  <body>
    <!-- ======= Header ======= -->
    <!-- End Header -->
    <header id="header" class="fixed-top d-flex align-items-center">
      <div class="container d-flex align-items-center justify-content-between">
        <div class="logo">
          <h1 class="text-light">
             
            <a href="home.html"><span>ContentBlitz</span></a>
          </h1>
          <!-- Uncomment below if you prefer to use an image logo -->
          <!-- <a href="home.html"><img src="assets/img/logo.png" alt="" class="img-fluid"></a>-->
        </div>

        <nav id="navbar" class="navbar">
          <ul>
            <li>
              <a class="nav-link scrollto active" href="home.html">Projects</a>
            </li>
            
            <li>
              <a class="nav-link scrollto" href="billing.html">Billing</a>
            </li>
            <li class="nav-item dropdown">
              <img src="assets/img/profile_icon.png" alt="User Avatar" class="user-avatar nav-link dropdown-toggle" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown">
                <!-- Dropdown items go here -->
                <p class="dropdown-item" id="userEmail"></p>
                <p class="dropdown-item" id="userCredits"></p>
                <div class="dropdown-divider"></div>
                <span class="dropdown-item" id="onLogout" style="cursor: pointer;">Logout</span>
              </div>
            </li>
          </ul>
          <i class="bi bi-list mobile-nav-toggle"></i>
        </nav>
        <!-- .navbar -->
      </div>
    </header>

    <div class="container-fluid col-10" style="margin-top: 7rem">
      

      <div class="header">
        <div class="row">
        </div>
        <!-- <p
          style="
            background-color: pink;
            display: inline-block;
            padding: 3px 10px;
            border-radius: 15px;
            margin-bottom: 5px;
          "
        >
          English
        </p> -->
      </div>

      <div id="accordion">
        <div class="card">
          <div class="card-header" style="background-color: transparent;">
            <h5 class="mb-0">
              <button class="btn btn-outline-secondary mx-2">Download as</button
              ><button class="btn btn-outline-secondary">
                Export to Website
              </button>
            </h5>
          </div>
        </div>

        <div id="wordReport" class="card">
          <!-- <div
            class="card-header"
            data-toggle="collapse"
            data-target="#collapseOne"
            aria-expanded="false"
            aria-controls="collapseOne"
            id="headingOne"
          >
            <h5 class="mb-0">
              <div class="row">
                <span class="col-11">AWS Cloud Cost</span
                ><i class="bi bi-chevron-down col-1"></i>
              </div>
            </h5>
          </div>

          <div
            id="collapseOne"
            class="collapse"
            aria-labelledby="headingOne"
            data-parent="#accordion"
          >
            <div class="card-body">
              Anim pariatur cliche reprehenderit, enim eiusmod high life
              accusamus terry richardson ad squid. 3 wolf moon officia aute, non
              cupidatat skateboard dolor brunch. Food truck quinoa nesciunt
              laborum eiusmod. Brunch 3 wolf moon tempor, sunt aliqua put a bird
              on it squid single-origin coffee nulla assumenda shoreditch et.
              Nihil anim keffiyeh helvetica, craft beer labore wes anderson cred
              nesciunt sapiente ea proident. Ad vegan excepteur butcher vice
              lomo. Leggings occaecat craft beer farm-to-table, raw denim
              aesthetic synth nesciunt you probably haven't heard of them
              accusamus labore sustainable VHS.
            </div>
          </div> -->
        </div>
      </div>
    </div>

    <div id="loadingSpinner" class="loading-spinner">
      <div class="spinner"></div>
    </div>

    <!-- Vendor JS Files -->
    <script src="assets/vendor/aos/aos.js"></script>
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="assets/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="assets/vendor/isotope-layout/isotope.pkgd.min.js"></script>
    <script src="assets/vendor/swiper/swiper-bundle.min.js"></script>
    <script src="assets/vendor/php-email-form/validate.js"></script>
   
    <script
      src="https://cdn.jsdelivr.net/npm/popper.js@1.12.9/dist/umd/popper.min.js"
      integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/js/bootstrap.min.js"
      integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
      crossorigin="anonymous"
    ></script>

    <!-- Template Main JS File -->
    <script src="assets/js/main.js"></script>

    <script>
      $(document).ready(function() {

        var user = JSON.parse(localStorage.getItem("user"));

        showLoadingSpinner();

        function showLoadingSpinner() {
          $("#loadingSpinner").show();
        }

        // Function to hide the loading spinner
        function hideLoadingSpinner() {
          $("#loadingSpinner").hide();
        }

        if (!user) {
          window.location.href = "/index.html";
        } else {
          $("#userEmail").text(user.email);
          $("#userCredits").text("Credits: " + user.credits);
        }

        $(document).on("click", "#onLogout", function() {
          // Code to be executed when the button is clicked
         localStorage.removeItem("user");
         window.location.href = "/index.html";
        });

        function getQueryParamValue(parameter) {
            var urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(parameter);
        }

        function populateCards(data) {
          var parent = $("#wordReport");
          $.each(data, function(index, item) {

            var statusText = "";

            if (item.article_requested === 1) {
              statusText = "(Pending)";
            }

            if (item.article_ready === 1) {
              statusText = "(Ready)"
            }

            

            var accHeader = $(`
            <div class="card-header"
              data-toggle="collapse"
              data-target="#collapse${item.id}"
              aria-expanded="false"
              aria-controls="collapse${item.id}"
              id="heading${item.id}"
            >
              <h5 class="mb-0">
                <div class="row">
                  <span class="col-11">${item.word} &nbsp &nbsp <span>${statusText}</span> </span
                  ><i class="bi bi-chevron-down col-1"></i>
                </div>
              </h5>
            </div>`);

            var accBottom = $(`<div
            id="collapse${item.id}"
            class="collapse"
            aria-labelledby="heading${item.id}"
            data-parent="#accordion"
          >
            <div class="card-body">
              ${atob(item.article_text)}
            </div>
          </div>`);
            
            parent.append(accHeader);
            if (item.article_ready === 1) {

              parent.append(accBottom);

            }
          });
        }
        
        var postId = getQueryParamValue('id');

        $.ajax({
          type: "GET",
          url: "https://app.contentblitz.ai:8080/api/v1/keywordsByPostId?postId="+postId, // Replace with your API endpoint URL
          success: function(data) {
              // Call the function to populate the table with the fetched data
              hideLoadingSpinner();
              populateCards(data.data);
          },
          error: function(error) {
            hideLoadingSpinner();
              console.error("Error:", error);
          }
       });

       
          
      });
    </script>
  </body>
</html>
